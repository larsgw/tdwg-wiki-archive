---+ Common Protocol Error Codes
[[#cat][Proposed Error Categories]]

[[#digir][Existing DiGIR Error Codes]]

[[#biocase][Existing BioCASE Error Codes]]

[[#common][Proposed New Error Codes]]


The existing protocols allow to create error messages, 
called diagnostics, in a response document.

Right now both protocols (DiGIR + BioCASE) allow a diagnostic message like this:

<verbatim>
 <diagnostic code="404" severity="info">detailed message goes here</diagnostic>
</verbatim>

for severity there is already a list of values:
<verbatim>
debug
info [default]
warn
error
fatal
</verbatim>

It would be good to have a basic set of error codes defined within the protocol, similar to http errors.

<a name="cat"></a>
---+++++ Proposed Error Code Categories
We suggest to classify all errors within the following categories and prefix all codes with this class:

   * *CFG - CONFIG*
      * CFG_CIRCULAR_TABLES - configured tables have a circular structure
      * ... configuration specific errors
   * *DBS - DATABASE*
      * DBS_CONNECTION - could not create a database connection
      * DBS_SQL - error when executing a SQL statement
      * ... database specific errors
   * *PRG - PROGRAM*
      * PRG_LIBRARY_MBSTRING - wrong version of the php mbstring library installed
      * ... implementation specific errors
   * *REQ - REQUEST*  - errors when dealing with the request. examples:
      * REQ_UNKOWN_SCHEMA
      * REQ_UNKOWN_CONCEPT
      * REQ_WRONG_VERSION
      * ... request specific errors
   * *RSP - RESPONSE*
      * ... response specific errors including data transformations


<a name="digir"></a>
---+++++ Existing DiGIR Error Codes
||*severity*||*code*||*meaning*||
||warn||PHP_VERSION||Indicates a mismatch between the version of PHP known to work correctly with DiGIR and the current PHP interpreter.||
||warn||FILTER_TOO_SHORT||The filter supplied in the request document was too brief (general) for this provider.||
||error||INVALID_QUERY||The query supplied in the request document could not be parsed in the context of the requested resource.||
||error||INTERNAL_DATABASE_ERROR||There was a problem with communication between the DiGIR script and the database that caused an error.||
||error||DATABASE_ERROR||Reports an error message that was generated by the database driver. The text of the message is the error message provided by the database interface.||
||debug||SQL_DEBUG_INFO||Contains native database query statements generated when the provider is in debug mode.||
||info||MATCH_COUNT||Contains the number of records that matched the query.  This is an integer value.||
||warn||QUERY_PRODUCED_NO_RESULTS||An error message that indicates the query produced a null (empty) resultset.||
||info||RECORD_COUNT||An integer value that indicates the number of records that are returned in the response.||
||info||END_OF_RECORDS||A boolean value (true | false, 0|1) indicating if the last record in the response document corresponds with the last record in the resultset.||
||error||BAD_QUERY||The filter structure could not be transformed into a native query language.||
||error||UNSUPPORTED_ACCESSPOINT||An access point (searchable concept) used in the filter does not exist in the resource.||
||error||COMPARISON_TYPE_NOT_SUPPORTED||A comparison type specified in the filter was not supported by the corresponding access point.||
||error||QUERY_TERM_TOO_SHORT||A term used in the query was shorted than the minimum allowed by the provider.||
||error||INVALID_QUERY_TERM||A query term was not in the expected form for the searchable concept.||
||error||BAD_CONCEPT_MAP||The configuration for the concept map element specified in the diagnostic message did not provide correct information for mapping to the database.||
||error||RESOURCE_NOT_FOUND||The requested resource was not available on the data provider.||
||error||INVALID_REQUEST||The request document was incorrect and the operation could not be determined.||
||error||LOAD_FORMAT_FAILED||The requested record format could not be found or loaded.||
||warn||METADATA_FORMAT_PROBLEM||There was a problem processing the provider metadata description file.||
||error||NO_FILTER_IN_REQUEST||No filter was provided in the search request.||
||error||COULD_NOT_LOAD_RESOURCES_FILE||The provider resource list could not be loaded.||
||error||REMOTE_JOINS_NOT_ALLOWED||The operation requested a remote join, and that feature has been disabled on the provider.||
||error||REMOTE_JOIN_FAILED||The remote join request failed to complete correctly.||
||warn||REMOTE_JOIN_INFO||The response from the remote join was different to expected, but the operation appeared to complete successfully.||
||fatal||FAILED_CONFIGURATION_LOAD||The configuration information for the provider could not be loaded, and hence the requested operation could not be completed.||
||warn||NO_CONTENT_REQUESTED||The request does not ask for match count or any records.||
||error||TOO_MANY_ERRORS||Too many errors were encountered while processing the request.||
||error||LOG_ERROR||Problem occured when opening or writing to the log.||
||error||GENERAL_ERROR||A catch-all diagnostic for where no other appropriate category is available.||
||warn||NO_CHARACTER_CONVERSION||The mbstring library was not available, and hence no character conversion routines are available. The resulting document may not conform to UTF-8 character encoding.||
||error||DIGIR_NOT_ALLOWED||The requested operation is not permitted by the configuration of the provider.||
||error||DIGIRM_RECURSIVE_OPERATION||The DiGIRm request resolved to a recursive query and so was not processed.||
||info||STATUS_INTERVAL||An integer value indicating the number of seconds for which the accompanying STATUS_DATA value applys.||
||info||STATUS_DATA||An integer value indicating the number of requests that have been processed in the last STATUS_INTERVAL seconds.  The count refers to the type of operation that generated the current document (e.g. metadata, search, or inventory).||

<a name="biocase"></a>
---+++++ Existing BioCASE Error Codes
||error||DBComplexError||temp error for too complex DBs not yet supported.||
||error||CGIError||Exception raised for errors encountered while retrieving the CGI request XML document.||
||error||CMFError||Exception raised for errors trying to parse a CMF file.||
||error||CMFVersionError||Exception raised for errors trying to deal with unknown versions of CMF.||
||error||CMFMaxAttributeError||Exception raised for wrong CMF files, that have more DB attributes mapped to a non or too little repeatable element.||
||error||ConnectionError||Exception raised for errors while establishing a DB connection.||
||error||DBAttrObjError||An expected DB-tuple was not found.||
||error||MissingRootTableError||Exception raised for errors trying to parse a CMF file.||
||error||NoFilterError||Exception raised for empty request filters.||
||error||ProviderSetupParseError||Exception raised for errors encountered while parsing the ProviderSetup.xml file.||
||error||RequestParseError||Exception raised for errors encountered while parsing the CGI request.||
||error||RequestedSchemaError||Exception raised for requested searches against schemas not supported by the provider.||
||error||RequestUnknownConceptError||Exception raised for requested searches referencing concepts not supported by the provider.||
||error||RequestNotSearchableConceptError||Exception raised for requested searches referencing concepts that are not searchable.||
||error||ResponseError||Exception raised for errors encountered while creating the response object.||
||error||SQLError||Exception raised for DB errors trying executing a SQL statement.||
||error||SQLgenerationError||Exception raised for errors encountered while generating a SQL string.||
||error||SQLunicodeGenerationError||Exception raised for non ANSI characters used in building a SQL string.||
||error||TableConfigError||Exception raised for any table configuration errors.||
||error||TableConfigAliasError||Exception raised for Table configurations that have a non unique alias name.||
||error||TableConfigCircleError||Exception raised for Table configurations that have a circular structure.||
||error||TestFileError||Exception raised for errors encountered while retrieving the test file request XML document.||
||error||UnicodeError||Exception raised because of unsupported Unicode funcionality.||
||error||unknownEncodingError||Exception raised for errors of unknown encoding entries in the providerConfig file.||
||error||unknownTypeError||Exception raised for errors of unknown type parameters in SQL strings or DB results.||
||error||wrongXMLTypeError||Exception raised for values of wrong type as specified in the XML schema.||
||error||wrongTypeForDBError||Exception raised for values that cannot be converted to a specified database type.||

<a name="common"></a>
---+ Proposed Common Error Codes

---+++++ configurations
||error||CFG_BAD_CONCEPT_MAP||The configuration for the concept map element specified in the diagnostic message did not provide correct information for mapping to the database.||
||error||CFG_FAILED_CONFIGURATION_LOAD||The configuration information for the provider could not be loaded, and hence the requested operation could not be completed.||
||error||CFG_COULD_NOT_DETECT_LOCAL_DATASOURCES||A provider service cannot detect the available local datasource services.||
||error||CFG_ParseConfigFileError||Exception raised for errors when trying to parse a configuration file XXX.||
||error||CFG_UnknownConfigVersionError||Exception raised for errors trying to deal with unknown versions of configuration file XXX.||
||error||CFG_MissingRootTableError||Exception raised for non existing or detectable root tables.||
||error||CFG_TableStructureError||Exception raised for configuration errors when analyzing the database table structure.||
||error||CFG_TableStructureCircleError||Exception raised for table configurations that have a circular structure.||
||error||CFG_NonUniqueTableAliasError||Exception raised for table configurations that have a non unique alias name.||
||error||CFG_UnknownEncodingError||Exception raised for unknown character encodings.||


---+++++ database
||error||DBS_INTERNAL_DATABASE_ERROR||There was a problem with communication between the DiGIR script and the database that caused an error.||
||error||DBS_DATABASE_ERROR||Reports an error message that was generated by the database driver. The text of the message is the error message provided by the database interface.||
||debug||DBS_SQL_DEBUG_INFO||Contains native database query statements generated when the provider is in debug mode.||
||error||DBS_ConnectionError||Exception raised for errors while establishing a db connection.||
||error||DBS_SQLError||Exception raised for db errors trying executing a SQL statement.||
||error||DBS_UnicodeError||Exception raised because of unsupported unicode funcionality in database driver.||
||error||DAT_SQLGenerationError||Exception raised for errors encountered while generating a SQL string.||
||error||DAT_SQLUnicodeGenerationError||Exception raised for non ANSI characters used in building a SQL string.||
||error||DAT_WrongTypeForDBError||Exception raised for values that cannot be converted to a specified database type.||
||error||DAT_UnknownTypeError||Exception raised for errors of unknown type parameters in SQL strings or DB results.||




---+++++ request
||error||REQ_FILTER_TOO_SHORT||The filter supplied in the request document was too brief (general) for this provider.||
||error||REQ_INVALID_QUERY||The query supplied in the request document could not be parsed in the context of the requested datasource.||
||error||REQ_INVALID_REQUEST||The request document was incorrect and the operation could not be determined.||
||error||REQ_BAD_QUERY||The filter structure could not be transformed into a native query language.||
||error||REQ_QUERY_TERM_TOO_SHORT||A term used in the query was shorted than the minimum allowed by the provider.||
||error||REQ_UNSUPPORTED_ACCESSPOINT||An access point (searchable concept) used in the filter does not exist in the resource.||
||error||REQ_COMPARISON_TYPE_NOT_SUPPORTED||A comparison type specified in the filter was not supported by the corresponding access point.||
||error||REQ_INVALID_QUERY_TERM||A query term was not in the expected form for the searchable concept.||
||error||REQ_DATASOURCE_NOT_FOUND||The requested datasource was not available.||
||error||REQ_DIGIR_NOT_ALLOWED||The requested operation is not permitted by the configuration of the provider.||
||warn||REQ_RequestLocationError||Warning raised when no request could be specified.||
||error||REQ_CGIError||Exception raised for errors encountered while retrieving the CGI request XML document.||
||error||REQ_ParseError||Exception raised for errors encountered while parsing the request.||
||error||REQ_UnknownSchemaError||Exception raised for requested searches against conceptual schemas not supported by the provider.||
||error||REQ_UnknownConceptError||Exception raised for requested searches referencing concepts not supported by the provider.||
||error||REQ_NotSearchableConceptError||Exception raised for requested searches referencing concepts that are not searchable.||


---+++++ response
||error||RSP_LOG_ERROR||Problem occured when opening or writing to the log.||
||warn||RSP_QUERY_PRODUCED_NO_RESULTS||An error message that indicates the query produced a null (empty) resultset.||
||warn||RSP_METADATA_FORMAT_PROBLEM||There was a problem processing the provider metadata description file.||
||warn||RSP_NO_CHARACTER_CONVERSION||No character conversion routines are available (e.g. mbstring for php). The resulting document may not conform to UTF-8 character encoding.||
||info||RSP_STATUS_INTERVAL||An integer value indicating the number of seconds for which the accompanying RSP_STATUS_DATA value applys.||
||info||RSP_STATUS_DATA||An integer value indicating the number of requests that have been processed in the last RSP_STATUS_INTERVAL seconds.  The count refers to the type of operation that generated the current document (e.g. metadata, search, or inventory).||
||error||RSP_ResponseError||Exception raised for errors encountered while creating the response object.||
||error||DAT_WrongXMLTypeError||Exception raised for values of wrong type as specified in a XML schema.||
||warn||DAT_MaxOccurError||Exception raised for too much records to populate a restricted non unbound repeatable element.||



---+++++ program
||error||PRG_GENERAL_ERROR||A catch-all diagnostic for where no other appropriate category is available.||
||error||PRG_LANGUAGE_VERSION||Indicates a mismatch between the version of the programming language interpreter known to work correctly with the software and the current interpreter.||
||error||PRG_DBAttrObjError||An expected DB-tuple was not found.||



---+++++ Unresolved codes
||||||*DiGIR codes not yet resolved*||
||error||DIGIRM_RECURSIVE_OPERATION||The DiGIRm request resolved to a recursive query and so was not processed.||
||error||REMOTE_JOINS_NOT_ALLOWED||The operation requested a remote join, and that feature has been disabled on the provider.||
||error||REMOTE_JOIN_FAILED||The remote join request failed to complete correctly.||
||warn||REMOTE_JOIN_INFO||The response from the remote join was different to expected, but the operation appeared to complete successfully.||
||warn||NO_CONTENT_REQUESTED||The request does not ask for match count or any records.||
||||||*BioCASE codes not yet resolved*||



